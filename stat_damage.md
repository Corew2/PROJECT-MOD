# 데미지 공식(나제불님님님 자료)

- stat_damage = (main_stat * 4 + sub_stat) * 0.01 * sum_att * weapon_constants(무기상수) * job_constants(직업상수)

- sum_armor_ignore = (1 - (100 - 방무1) / 100 * (100 - 방무2) / 100 * (100 - 방무3) / 100 * …) * 100 (%)
- 방무 계산 : 100 - 몬스터 방어율 - (몬스터 방어율 x 실제 방어율무시)

- 데미지
    - [(주스탯 * 4 + 부스탯) * 총 공격력 * 무기상수 * 직업보정상수 ] * 숙련도 보정 *
	(크리티컬 100%를 디폴트 값으로) 크리티컬 데미지 보정 * (1 + 데미지% + 보공%) * (1 + 공격력%) *
	방어율 무시 보정 * 렙차 보정 * 속성 보정 * (스킬 퍼뎀 / 100) * 
	(아케인포스 필요 적의 경우) 아케인포스 보정 * [ (모든 최종데미지 계산값% + 1 ]


- 스공 계산
  - 앞스공 = 숙련도% * 뒷스공
  - 뒷스공 = (main_stat * 4 + sub_stat) * 0.01 * 총 att * 무기상수 * 직업상수 * (1 + patt%) * (1 + damage%) * (1 + final_damage%)
  - 무기상수와 직업상수는 재정의 필요없이 수식을 뒤로 빼서 각 Character 객체에서 추가적으로 계산하도록 설계
  - 최종뎀은 직업마다 달라 각 Character 객체에서 정의.


- 무기상수 
  - 각 무기별로 고유하게 갖고 있는 상수값으로, 1(스태프 등)부터 1.75(아대) 까지의 값을 가짐

- 직업상수
  - 일부 직업이 갖고 있는 보정상수입니다.
  - 일부 마법사 직업군은 무기상수와 별개로 1.2의 보정 상수를 가지며, 제논의 경우 0.875의 보정 상수를 갖습니다.

- (크리티컬 발동 시)크리티컬 보정
  - 크리티컬 발동 시 데미지 보정값을 의미하는데, 크리티컬 데미지는 20 ~ 50%의 기본 값을 가지며, 이 기본 값의 최소, 최댓값에 크리티컬 데미지가 합산되는 형태입니다. 예를 들어 스탯창에 표시된 크리티컬 데미지가 50%라면 (20+50) ~ (50+50)%, 즉 70 ~ 100%의 크리티컬 데미지가 적용되며 이는 곧 크리티컬이 발동할 경우 1.7 ~ 2.0배의 데미지가 들어감을 말합니다. 크리티컬 데미지 보정 계산 공식은 다음과 같습니다. [ (120 + 크리티컬 데미지) / 100 ] ~ [ (150 + 크리티컬 데미지) / 100]  (1.2) 위 식의 값을 계산식에 곱해 주면 됩니다. 데미지의 값들은 정규분포를 띨 것으로 추정되기에, 일반적으로 데미지 기댓값을 구할 때에는 두 값의 평균을 사용합니다.

- 아케인 심볼, 어센틱 심볼
  - 아케인 심볼과 어센틱 심볼의 스텟은 스텟%가 적용 안됨.

- 방어율 무시 보정
  - 100 - ( 몬스터 방어율 - 몬스터 방어율 * 총 방어율 무시) (%)

- 렙차 보정
  - 몬스터와 자신간의 레벨 차이에 따라 발생하는 데미지 차이 보정으로, 레벨 차이가 0일 경우 1.1배의 데미지를, 유저의 레벨이 5 이상 높을 경우 1.2배의 데미지를 줄 수 있습니다.

- 숙련도 보정
  - 무기와 직업 스킬에 따라 존재하는 숙련도에 대한 보정값입니다.
  - 원거리 무기는 15%, 근거리 무기는 20%, 마법 무기는 25%의 기본 숙련도를 가지며 스킬을 통해 숙련도 수치는 오를 수 있습니다.
  - 숙련도가 15%라는 것은 15%~100% 사이의 데미지가 뜬다는 것을 의미합니다.
  - 일반적으로는 직업 스킬에서 총 70%의 숙련도를 올릴 수 있으며 원거리 무기는 85%, 근거리 무기는 90%, 마법 무기는 95%의 숙련도 값을 최종적으로 갖게 됩니다.
	 다만 엔젤릭버스터는 200레벨 달성 시 퀘스트를 통해 숙련도 10%를 추가로 올려주는 스킬을 받을 수 있으며(숙련도 95%), 일부 직업은 쓸만한 컴뱃 오더스 혹은 컴뱃 오더스로 숙련도를 추가 증가시킬 수 있습니다.
  - 다만 숙련도는 95% 이상으로 올라가지 않습니다.
  - 숙련도에 따른 데미지 보정 역시 이에 따른 보정된 데미지들의 값들은 정규분포를 띨 것으로 생각되기에, 숙련도와 1의 평균값을 통해 데미지 기댓값을 산출합니다.

- 최종데미지
	- 서로 곱연산되며, 위 식 (1.1)에서 모든 최종데미지 계산값%는 다음과 같이 계산합니다.
  - [(100 + 최종데미지 1) / 100 * (100 + 최종데미지 2) / 100 * … ] * 100 - 100  

  - 만약에 여기에 최종데미지 50퍼짜리 스킬을 하나 더썼다면 
	- 최종데미지 30퍼에 50을 더해서 80퍼센트를 곱해주는것이 아니고 이미 30퍼센트가 계산된 364에 1.5를 곱해서 546퍼, 5.46배의 데미지가 들어간다는것입니다 
  - 효율측면에서 최종데미지는 계속 곱해주는 것이기때문에 그냥 많을수록 무지무지 좋은것이고,
  - 데미지와 보스데미지는 계속 더해주는것이기때문에 많을수록 효율이 떨어진다는것입니다.